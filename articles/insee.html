<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial â€¢ insee</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial">
<meta property="og:description" content="insee">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">insee</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/insee.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v2_gdp-vignettes.html">GDP growth rate</a>
    </li>
    <li>
      <a href="../articles/v3_inflation-vignettes.html">Inflation</a>
    </li>
    <li>
      <a href="../articles/v4_unem-vignettes.html">Unemployment rate</a>
    </li>
    <li>
      <a href="../articles/v5_pop-vignettes.html">Population by age</a>
    </li>
    <li>
      <a href="../articles/v6_pop_map-vignettes.html">Population Map</a>
    </li>
    <li>
      <a href="../articles/v7_death_birth-vignettes.html">Deaths and Births</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pyr-opendatafr/R-Insee-Data/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="insee_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tutorial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pyr-opendatafr/R-Insee-Data/blob/master/vignettes/insee.Rmd"><code>vignettes/insee.Rmd</code></a></small>
      <div class="hidden name"><code>insee.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <a href="https://CRAN.R-project.org/package=insee">insee</a> package gathers tools to easily download data and metadata from <a href="https://www.insee.fr/en/information/2512785">insee BDM database</a>.</p>
<p>It uses SDMX queries under the hood. Have a look at the detailed <a href="https://www.insee.fr/en/information/2868055">SDMX webservice page</a>.</p>
<p>The first version of the package was published on CRAN 2020-07-29.</p>
<div id="proxy-issues" class="section level2">
<h2 class="hasAnchor">
<a href="#proxy-issues" class="anchor"></a>Proxy issues</h2>
<center>
<font color="red"> <strong>Requirement for INSEE employees</strong></font>
</center>
<p>In order for someone working behind a proxy server to be able to use <a href="https://CRAN.R-project.org/package=insee">insee</a>, it is necessary to modify system variables as follow.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span><span class="op">(</span>http_proxy <span class="op">=</span> <span class="st">"my_proxy_server"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span><span class="op">(</span>https_proxy <span class="op">=</span> <span class="st">"my_proxy_server"</span><span class="op">)</span></code></pre></div>
</div>
<div id="installation-loading" class="section level2">
<h2 class="hasAnchor">
<a href="#installation-loading" class="anchor"></a>Installation &amp; Loading</h2>
<p>You can easily install <a href="https://CRAN.R-project.org/package=insee">insee</a> with the following code :</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get the development version from GitHub </span>
<span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"InseeFr/R-Insee-Data"</span><span class="op">)</span>

<span class="co"># CRAN version</span>
<span class="co"># install.packages("insee")</span>

<span class="co"># library Loading</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pyr-opendatafr.github.io/R-Insee-Data/">insee</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="functionalities" class="section level1">
<h1 class="hasAnchor">
<a href="#functionalities" class="anchor"></a>Functionalities</h1>
<p>This section will give you an overview of what you can do with <a href="https://CRAN.R-project.org/package=insee">insee</a>.</p>
<p>Series have two identifiers the SDMX identifier and the so called idbank. Both can be used to download data.</p>
<div id="datasets-list" class="section level2">
<h2 class="hasAnchor">
<a href="#datasets-list" class="anchor"></a>Datasets List</h2>
<p><a href="https://www.insee.fr/en/information/2512785">INSEE BDM database</a> offers more than 200 Datasets. The <code><a href="../reference/get_dataset_list.html">get_dataset_list()</a></code> function returns the datasets catalogue :</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insee_dataset</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_dataset_list.html">get_dataset_list</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
</div>
<div id="series-keys-list" class="section level2">
<h2 class="hasAnchor">
<a href="#series-keys-list" class="anchor"></a>Series Keys List</h2>
<p><a href="https://www.insee.fr/en/information/2512785">INSEE BDM database</a> currently offers more than 150 000 series. The <code>get_idbank_list</code> function returns the series catalogue from a dataset name.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">idbank_list</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_idbank_list.html">get_idbank_list</a></span><span class="op">(</span><span class="st">'BALANCE-PAIEMENTS'</span><span class="op">)</span></code></pre></div>
</div>
<div id="find-a-series-key" class="section level2">
<h2 class="hasAnchor">
<a href="#find-a-series-key" class="anchor"></a>Find a series key</h2>
<p>The best way to download data is to find the right series key (idbank), but how ? Indeed, in some cases it is not easy to understand what are the differences among series, especially for non-French speakers. To make the search easier, the best way is to use the <code>get_idbank_list</code> function with a dataset name, then it can be helpful to filter with the columns FREQ, NATURE, UNIT etc. Moreover, the <a href="https://CRAN.R-project.org/package=insee">insee</a> package provides the function <code>add_insee_title</code> to get titles from idbanks, either in English or in French. It is not advised to use the function on the whole idbank dataset, as each SDMX query has 400-idbank limit. Then, <code>add_insee_title</code> function splits the list into several lists of 400 idbanks each. Thus, the user should filter the idbank dataset before using the function to avoid as much as possible this bottleneck as the following example shows. After the data retrieval, it is really nice to use the <code>split_title</code> function on the dataframe to get more readable titles easy to use in plots and <code>add_insee_metadata</code> to get the metadata with the data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">idbank_list_selected</span> <span class="op">=</span>
  <span class="fu"><a href="../reference/get_idbank_list.html">get_idbank_list</a></span><span class="op">(</span><span class="st">"IPI-2015"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">#industrial production index dataset</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">FREQ</span> <span class="op">==</span> <span class="st">"M"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">#monthly</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">NATURE</span> <span class="op">==</span> <span class="st">"INDICE"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">#index</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">CORRECTION</span> <span class="op">==</span> <span class="st">"CVS-CJO"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">#Working day and seasonally adjusted SA-WDA</span>
  <span class="co">#automotive industry and overall industrial production</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">NAF2</span>,<span class="st">"^29$|A10-BE"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/add_insee_title.html">add_insee_title</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Another way to find a series key is to perform a keyword-based search with the function <code>search_insee</code>. Beware that this function uses package internal data which might not be the most up-to-date. See the following examples :</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># search multiple patterns</span>
<span class="va">dataset_survey_gdp</span> <span class="op">=</span> <span class="fu"><a href="../reference/search_insee.html">search_insee</a></span><span class="op">(</span><span class="st">"Survey|gdp"</span><span class="op">)</span>

<span class="co"># data about paris</span>
<span class="va">data_paris</span> <span class="op">=</span> <span class="fu"><a href="../reference/search_insee.html">search_insee</a></span><span class="op">(</span><span class="st">'paris'</span><span class="op">)</span>

<span class="co"># all data</span>
<span class="va">data_all</span> <span class="op">=</span> <span class="fu"><a href="../reference/search_insee.html">search_insee</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="download-data" class="section level2">
<h2 class="hasAnchor">
<a href="#download-data" class="anchor"></a>Download data</h2>
<div id="download-using-a-list-of-idbanks" class="section level3">
<h3 class="hasAnchor">
<a href="#download-using-a-list-of-idbanks" class="anchor"></a>Download using a list of idbanks</h3>
<p>The <code>get_insee_idbank</code> function should handle up to 1200 idbanks. It is then advised to narrow down the idbanks list used as argument of the function. Otherwise, put the limit argument to FALSE to ignore the functionâ€™s idbank limit.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pyr-opendatafr.github.io/R-Insee-Data/">insee</a></span><span class="op">)</span>

<span class="co"># the user can make a manual list of idbanks to get the data </span>
<span class="co"># example 1</span>

<span class="va">data</span> <span class="op">=</span> 
  <span class="fu"><a href="../reference/get_insee_idbank.html">get_insee_idbank</a></span><span class="op">(</span><span class="st">"001558315"</span>, <span class="st">"010540726"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/add_insee_metadata.html">add_insee_metadata</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># using a list of idbanks extracted from the insee idbank dataset</span>
<span class="co"># example 2 : household's confidence survey</span>

<span class="va">df_idbank</span> <span class="op">=</span> 
  <span class="fu"><a href="../reference/get_idbank_list.html">get_idbank_list</a></span><span class="op">(</span><span class="st">"ENQ-CONJ-MENAGES"</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co">#monthly households' confidence survey</span>
  <span class="fu"><a href="../reference/add_insee_title.html">add_insee_title</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">CORRECTION</span> <span class="op">==</span> <span class="st">"CVS"</span><span class="op">)</span> <span class="co">#seasonally adjusted</span>

<span class="va">list_idbank</span> <span class="op">=</span> <span class="va">df_idbank</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">idbank</span><span class="op">)</span>

<span class="va">data</span> <span class="op">=</span> 
  <span class="fu"><a href="../reference/get_insee_idbank.html">get_insee_idbank</a></span><span class="op">(</span><span class="va">list_idbank</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/split_title.html">split_title</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/add_insee_metadata.html">add_insee_metadata</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># example 3 : get more than 1200 idbanks</span>

<span class="va">idbank_dataset</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_idbank_list.html">get_idbank_list</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">df_idbank</span> <span class="op">=</span> 
  <span class="va">idbank_dataset</span> <span class="op">%&gt;%</span>
  <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1201</span><span class="op">)</span>

<span class="va">list_idbank</span> <span class="op">=</span> <span class="va">df_idbank</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">idbank</span><span class="op">)</span>

<span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_insee_idbank.html">get_insee_idbank</a></span><span class="op">(</span><span class="va">list_idbank</span>, firstNObservations <span class="op">=</span> <span class="fl">1</span>, limit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div id="download-using-a-dataset-name" class="section level3">
<h3 class="hasAnchor">
<a href="#download-using-a-dataset-name" class="anchor"></a>Download using a dataset name</h3>
<p>For some datasets as IPC-2015 (inflation), the filter is necessary.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insee_dataset</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_dataset_list.html">get_dataset_list</a></span><span class="op">(</span><span class="op">)</span> 

<span class="co"># example 1 : full dataset</span>
<span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_insee_dataset.html">get_insee_dataset</a></span><span class="op">(</span><span class="st">"CLIMAT-AFFAIRES"</span><span class="op">)</span>

<span class="co"># example 2 : filtered dataset </span>
<span class="co"># the user can filter the data</span>
<span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_insee_dataset.html">get_insee_dataset</a></span><span class="op">(</span><span class="st">"IPC-2015"</span>, filter <span class="op">=</span> <span class="st">"M+A.........CVS."</span>, startPeriod <span class="op">=</span> <span class="st">"2015-03"</span><span class="op">)</span>

<span class="co"># in the filter, the + is used to select several values in one dimension, like an "and" statement</span>
<span class="co"># the void means "all" values available</span>

<span class="co"># example 3 : only one series</span>
<span class="co"># by filtering with the full SDMX series key, the user will get only one series</span>
<span class="va">data</span> <span class="op">=</span> 
  <span class="fu"><a href="../reference/get_insee_dataset.html">get_insee_dataset</a></span><span class="op">(</span><span class="st">"CNA-2014-CPEB"</span>,
                    filter <span class="op">=</span> <span class="st">"A.CNA_CPEB.A38-CB.VAL.D39.VALEUR_ABSOLUE.FE.EUROS_COURANTS.BRUT"</span>,
                    lastNObservations <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<ul>
<li><a href="https://pyr-opendatafr.github.io/R-Insee-Data/articles/v2_gdp-vignettes.html">GDP growth rate</a></li>
<li><a href="https://pyr-opendatafr.github.io/R-Insee-Data/articles/v3_inflation-vignettes.html">Inflation</a></li>
<li><a href="https://pyr-opendatafr.github.io/R-Insee-Data/articles/v4_unem-vignettes.html">Unemployment rate</a></li>
<li><a href="https://pyr-opendatafr.github.io/R-Insee-Data/articles/v5_pop-vignettes.html">Population by age</a></li>
<li><a href="https://pyr-opendatafr.github.io/R-Insee-Data/articles/v6_pop_map-vignettes.html">Population map</a></li>
<li><a href="https://pyr-opendatafr.github.io/R-Insee-Data/articles/v7_death_birth-vignettes.html">Deaths and Births</a></li>
</ul>
</div>
<div id="support" class="section level1">
<h1 class="hasAnchor">
<a href="#support" class="anchor"></a>Support</h1>
<p>Feel free to open an issue with any question about this package using <a href="https://github.com/pyr-opendatafr/R-Insee-Data" class="uri">https://github.com/pyr-opendatafr/R-Insee-Data</a> Github repository</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Hadrien Leclerc.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
